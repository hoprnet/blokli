# Default values for blokli
## @section Global Configuration ###
image:
  ## @param image.registry Container image registry
  ##
  registry: "europe-west3-docker.pkg.dev/hoprassociation/docker-images"
  ## @param image.repository Container image repository
  ##
  repository: "bloklid"
  ## @param image.pullPolicy Container image pull policy
  ##
  pullPolicy: Always
  ## @param image.tag Container image tag (defaults to chart appVersion if not specified)
  ##
  tag: ""
## @param imagePullSecrets Image pull secrets for private registries
##
imagePullSecrets: []
# - name: my-registry-secret

## @param nameOverride Override the chart name
##
nameOverride: ""
## @param fullnameOverride Override the full release name
##
fullnameOverride: ""
serviceAccount:
  ## @param serviceAccount.create Specifies whether a service account should be created
  ##
  create: true
  ## @param serviceAccount.annotations Annotations to add to the service account
  ##
  annotations: {}
  ## @param serviceAccount.name The name of the service account to use. If not set and create is true, a name is generated using the fullname template
  ##
  name: ""
## @param podAnnotations Annotations to add to the pod
podAnnotations: {}
podSecurityContext:
  ## @param podSecurityContext.runAsNonRoot Run container as non-root user
  ##
  runAsNonRoot: true
  ## @param podSecurityContext.runAsUser User ID to run the container
  ##
  runAsUser: 65532
  ## @param podSecurityContext.runAsGroup Group ID to run the container
  ##
  runAsGroup: 65532
  ## @param podSecurityContext.fsGroup File system group ID
  ##
  fsGroup: 65532
securityContext:
  ## @param securityContext.allowPrivilegeEscalation Prevent privilege escalation
  ##
  allowPrivilegeEscalation: false
  capabilities:
    ## @param securityContext.capabilities.drop Capabilities to drop
    ##
    drop:
      - ALL
  ## @param securityContext.readOnlyRootFilesystem Mount root filesystem as read-only
  ##
  readOnlyRootFilesystem: true
  ## @param securityContext.runAsNonRoot Run container as non-root user
  ##
  runAsNonRoot: true
  ## @param securityContext.runAsUser User ID to run the container
  ##
  runAsUser: 65532
service:
  ## @param service.type Service type
  ##
  type: ClusterIP
  ## @param service.port Service port for GraphQL API
  ##
  port: 8080
  ## @param service.annotations Service annotations
  ##
  annotations: {}
ingress:
  ## @param ingress.enabled Enable ingress for GraphQL API
  ##
  enabled: false
  ## @param ingress.className Ingress class name
  ##
  className: ""
  ## @param ingress.annotations Ingress annotations
  ##
  annotations: {}
  # cert-manager.io/cluster-issuer: letsencrypt-prod

  ## @param ingress.hostname Hostnames for the GraphQL API
  ##
  hostname: ""
  ## @param ingress.tls Enable TLS configuration for ingress. It will reference a secret named <hostname>-tls. Where hostname dots are replaced with dashes.
  ##
  tls: true
## @param resources Resource requests and limits
##
# Sizing guidance:
#   Small (dev/test):     requests: 250m/512Mi, limits: 1000m/2Gi
#   Medium (production):  requests: 500m/1Gi,   limits: 2000m/4Gi
#   Large (high traffic): requests: 1000m/2Gi,  limits: 4000m/8Gi
resources: {}
# Liveness probe configuration
livenessProbe:
  ## @param livenessProbe.enabled Enable liveness probe
  ##
  enabled: true
  ## @param livenessProbe.initialDelaySeconds Initial delay before liveness probe starts
  ##
  initialDelaySeconds: 30
  ## @param livenessProbe.periodSeconds Period between liveness probe checks
  ##
  periodSeconds: 10
  ## @param livenessProbe.timeoutSeconds Timeout for liveness probe
  ##
  timeoutSeconds: 5
  ## @param livenessProbe.successThreshold Success threshold for liveness probe
  ##
  successThreshold: 1
  ## @param livenessProbe.failureThreshold Failure threshold for liveness probe
  ##
  failureThreshold: 3
# Readiness probe configuration
readinessProbe:
  ## @param readinessProbe.enabled Enable readiness probe
  ##
  enabled: true
  ## @param readinessProbe.initialDelaySeconds Initial delay before readiness probe starts
  ##
  initialDelaySeconds: 10
  ## @param readinessProbe.periodSeconds Period between readiness probe checks
  ##
  periodSeconds: 5
  ## @param readinessProbe.timeoutSeconds Timeout for readiness probe
  ##
  timeoutSeconds: 3
  ## @param readinessProbe.successThreshold Success threshold for readiness probe
  ##
  successThreshold: 1
  ## @param readinessProbe.failureThreshold Failure threshold for readiness probe
  ##
  failureThreshold: 3
# Startup probe configuration
startupProbe:
  ## @param startupProbe.enabled Enable startup probe
  ##
  enabled: true
  ## @param startupProbe.initialDelaySeconds Initial delay before startup probe starts
  ##
  initialDelaySeconds: 0
  ## @param startupProbe.periodSeconds Period between startup probe checks
  ##
  periodSeconds: 10
  ## @param startupProbe.timeoutSeconds Timeout for startup probe
  ##
  timeoutSeconds: 3
  ## @param startupProbe.successThreshold Success threshold for startup probe
  ##
  successThreshold: 1
  ## @param startupProbe.failureThreshold Failure threshold for startup probe (allows up to 5 minutes for startup)
  ##
  failureThreshold: 30
## @param nodeSelector Node selector for pod assignment
##
nodeSelector: {}
## @param tolerations Tolerations for pod assignment
##
tolerations: []
## @param affinity Affinity rules for pod assignment
##
affinity: {}
# Monitoring configuration
monitoring:
  serviceMonitor:
    ## @param monitoring.serviceMonitor.enabled Enable ServiceMonitor creation
    ##
    enabled: false
    ## @param monitoring.serviceMonitor.namespace ServiceMonitor namespace (defaults to release namespace)
    ##
    namespace: ""
    ## @param monitoring.serviceMonitor.labels ServiceMonitor labels
    ##
    labels: {}
    ## @param monitoring.serviceMonitor.interval Scrape interval
    ##
    interval: 30s
    ## @param monitoring.serviceMonitor.scrapeTimeout Scrape timeout
    ##
    scrapeTimeout: 10s
    ## @param monitoring.serviceMonitor.path Metrics path (update when metrics endpoint is implemented)
    ##
    path: /metrics
## @param extraEnv Additional environment variables
##
extraEnv: []
# - name: CUSTOM_VAR
#   value: "custom-value"

## @param extraVolumes Additional volumes
##
extraVolumes: []
# - name: custom-volume
#   emptyDir: {}

## @param extraVolumeMounts Additional volume mounts
##
extraVolumeMounts: []
# - name: custom-volume
#   mountPath: /custom-path

## @section Blokli Application Configuration ###

# Persistence configuration for data directory
persistence:
  ## @param persistence.enabled Enable persistence for data directory
  ##
  enabled: true
  ## @param persistence.storageClass Storage class for PVC
  ##
  # If undefined (the default) or set to null, no storageClassName spec is set,
  # choosing the default provisioner
  storageClass: ""
  ## @param persistence.accessModes Access mode for PVC
  ##
  accessModes:
    - ReadWriteOnce
  ## @param persistence.size Size of the PVC
  ##
  size: 10Gi
  ## @param persistence.annotations Annotations for the PVC
  ##
  annotations: {}
  ## @param persistence.selector Selector for existing PV (optional)
  ##
  selector: {}
# Database configuration
database:
  ## @param database.type Database type (e.g., postgresql, sqlite)
  ##
  type: ""
  ## @param database.host PostgreSQL host
  ##
  host: ""
  ## @param database.port PostgreSQL port
  ##
  port: 5432
  ## @param database.database PostgreSQL database name
  ##
  database: ""
  ## @param database.username PostgreSQL username
  ##
  username: ""
  ## @param database.password PostgreSQL password (ignored if existingSecret is set)
  ##
  password: ""
  ## @param database.index_path Sqlite database file path (used only if database.type is "sqlite")
  ##
  index_path: ""
  ## @param database.logs_path Sqlite logs database file path (used only if database.type is "sqlite")
  ##
  logs_path: ""
  ## @param database.existingSecret Name of existing secret containing database credentials
  ##
  ## Secret should contain key BLOKLI_DATABASE_URL with the full database URL in the format: postgresql://username:password@host:port/database
  existingSecret: ""
  ## @param database.maxConnections Maximum number of database connections
  ##
  maxConnections: 10
# Bloklid configuration
config:
  ## @param config.network HOPR network to index (e.g., dufour, rotsee, jura)
  ##
  network: "dufour"
  ## @param config.rpcUrl Blockchain RPC URL
  ##
  rpcUrl: ""
  ## @param config.maxRpcRequestsPerSec Maximum RPC requests per second (0 = unlimited)
  ##
  maxRpcRequestsPerSec: 0
  ## @param config.dataDirectory Data directory path (should match persistence mount path)
  ##
  dataDirectory: "/data"
  # Indexer settings
  indexer:
    ## @param config.indexer.fastSync Enable fast sync mode
    ##
    fastSync: true
    ## @param config.indexer.enableLogsSnapshot Enable logs snapshot feature
    ##
    enableLogsSnapshot: false
    ## @param config.indexer.logsSnapshotUrl URL for logs snapshot download (required when enableLogsSnapshot is true)
    ##
    logsSnapshotUrl: ""
    # Subscription behavior configuration
    subscription:
      ## @param config.indexer.subscription.eventBusCapacity Capacity of the event bus buffer for channel events
      ##
      # Higher values prevent overflow but use more memory
      eventBusCapacity: 1000
      ## @param config.indexer.subscription.shutdownSignalCapacity Capacity of the shutdown signal buffer
      ##
      # Typically a small value is sufficient
      shutdownSignalCapacity: 10
      ## @param config.indexer.subscription.batchSize Batch size for Phase 1 historical channel queries
      ##
      # Higher values fetch more data per query but may increase latency
      batchSize: 100
  # API server configuration
  api:
    ## @param config.api.enabled Enable or disable the GraphQL API server
    ##
    enabled: true
    ## @param config.api.bindAddress Address and port for the API server to bind to
    ##
    bindAddress: "0.0.0.0:8080"
    ## @param config.api.playgroundEnabled Enable GraphQL Playground for development and testing. Recommended to set to false for production deployments
    ##
    playgroundEnabled: false
    ## @param config.api.gasMultiplier Multiplier for gas estimation to provide a safety margin (e.g., 1.2 for 20% extra)
    ##
    gasMultiplier: 1.2
    # Health check configuration
    health:
      ## @param config.api.health.maxIndexerLag Maximum indexer lag (blocks) before readiness fails
      ##
      maxIndexerLag: 10
      ## @param config.api.health.timeout Timeout for health check operations
      ##
      timeout: "5s"
      ## @param config.api.health.readinessCheckInterval Interval for periodic readiness checks
      ##
      readinessCheckInterval: "60s"
  # Logging configuration
  logging:
    ## @param config.logging.level Rust log level configuration. Examples: "info", "debug", "info,blokli_chain_indexer=debug"
    ##
    level: "info"
    ## @param config.logging.backtrace Rust backtrace configuration (e.g., "full", "short", "0")
    ##
    backtrace: full
    ## @param config.logging.format Log output format ("json" or empty for plain text)
    ##
    format: json
